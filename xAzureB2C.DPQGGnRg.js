import{d as f,g as A,_ as C,c,a as i,b as r,f as d,t as g,o as l}from"./xindex.nwv0rKjI.js";import{P as y,L as m}from"./xPublicClientApplication.c7WQpPdB.js";const a={authorityDomain:"areve2.b2clogin.com",policies:{signUpSignIn:{name:"B2C_1_SignUpOrSignInWithPassword_V3",authority:"https://areve2.b2clogin.com/areve2.onmicrosoft.com/B2C_1_SignUpOrSignInWithPassword_V3"},editProfile:{name:"B2C_1_UserProfileUpdate_V3",authority:"https://areve2.b2clogin.com/areve2.onmicrosoft.com/B2C_1_UserProfileUpdate_V3"},passwordReset:{name:"B2C_1_PasswordReset_V3",authority:"https://areve2.b2clogin.com/areve2.onmicrosoft.com/B2C_1_PasswordReset_V3"}}},u={auth:{clientId:"29d068df-2e97-4542-bced-5a708c722f0a",authority:a.policies.signUpSignIn.authority,knownAuthorities:[a.authorityDomain],redirectUri:document.location.origin,postLogoutRedirectUri:document.location.href},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:(e,o,p)=>{if(!p)switch(e){case m.Error:return console.error(o);case m.Warning:return console.warn(o);default:console.debug(o)}}}}},U=f({name:"AzureAD",setup:()=>({clientApplication:new y(u)}),data:()=>({account:void 0}),created(){const e=t=>{this.account=t},o=()=>{const t=this.clientApplication.getAllAccounts();if(!(t.length<1))if(t.length>1){const n=t.filter(s=>s.homeAccountId.toUpperCase().includes(a.policies.signUpSignIn.name.toUpperCase())&&s.idTokenClaims.iss.toUpperCase().includes(a.authorityDomain.toUpperCase())&&s.idTokenClaims.aud===u.auth.clientId);n.length>1?n.every(s=>s.localAccountId===n[0].localAccountId)?e(n[0]):this.signOut():n.length===1&&e(n[0])}else t.length===1&&e(t[0])};o();const p=async t=>{t!==null?e(t.account):o()};this.clientApplication.handleRedirectPromise().then(p).catch(t=>{if(t.errorMessage.indexOf("AADB2C90091:")===0){console.debug(t.errorMessage),A.push({path:"/azure-b2c",force:!0});return}if(t.errorMessage.indexOf("AADB2C90118:")===0){console.debug(t.errorMessage),this.passwordReset();return}console.error(t)})},computed:{username(){var e;return((e=this.account)==null?void 0:e.username)||""},name(){var e;return((e=this.account)==null?void 0:e.name)||""}},methods:{signIn(){this.clientApplication.loginRedirect({scopes:["openid","https://areve2.onmicrosoft.com/helloapi/demo.read"]})},signOut(){this.clientApplication.logoutRedirect({account:this.clientApplication.getAccountByUsername(this.username),postLogoutRedirectUri:u.auth.postLogoutRedirectUri})},editProfile(){const e={authority:a.policies.editProfile.authority,scopes:[],redirectStartPage:u.auth.postLogoutRedirectUri};this.clientApplication.loginRedirect(e)},passwordReset(){const e={authority:a.policies.passwordReset.authority,scopes:[],redirectStartPage:u.auth.postLogoutRedirectUri};this.clientApplication.loginRedirect(e)}}}),b=r("h1",null,"Azure B2C",-1),R=r("p",null,"Experimenting with a Azure B2C, you can sign-up for an account and sign-in with it, nothing else happens.",-1),P={key:0};function _(e,o,p,t,n,s){return l(),c("article",null,[b,i(),R,i(),r("div",null,[e.account?d("",!0):(l(),c("button",{key:0,onClick:o[0]||(o[0]=h=>e.signIn()),type:"button"},"Sign-in")),i(),e.account?(l(),c("button",{key:1,onClick:o[1]||(o[1]=h=>e.signOut()),type:"button"},"Sign-out")):d("",!0),i(),e.account?(l(),c("button",{key:2,onClick:o[2]||(o[2]=h=>e.editProfile()),type:"button"},`
        Edit Profile
      `)):d("",!0)]),i(),e.account?(l(),c("div",P,[r("p",null,"username: "+g(e.username),1),i(),r("p",null,"name: "+g(e.name),1),i(),r("pre",null,g(e.account),1)])):d("",!0)])}const k=C(U,[["render",_]]);export{k as default};
