import{k as y,d as G,g as w,_ as I,c as h,a as u,b as d,t as r,f,F as v,o as p,p as z,e as _}from"./xindex.nwv0rKjI.js";const g=Symbol("gAuth");window.gapi=null;const S=(t,e)=>{const i={scope:"profile email",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]};t.prompt="select_account",typeof e=="object"?(t.GoogleAuthConfig=Object.assign(i,e),e.scope&&(t.GoogleAuthConfig.scope=e.scope),e.prompt&&(t.prompt=e.prompt),e.clientId||console.warn("clientId is required")):console.warn("invalid option type. Object type accepted only")},P=()=>{const t="https://apis.google.com/js/api.js";return new Promise(e=>{const i=document.createElement("script");i.src=t,i.onreadystatechange=i.onload=()=>{(!i.readyState||/loaded|complete/.test(i.readyState))&&setTimeout(()=>{e()},500)},document.getElementsByTagName("head")[0].appendChild(i)})},N=t=>new Promise((e,i)=>{window.gapi.load("auth2",()=>{window.gapi.auth2.init(t).then(()=>{e(window.gapi)}).catch(o=>{i(o)})})}),O=(t,e,i)=>{P().then(()=>N(e)).then(o=>{t.GoogleAuth=o.auth2.getAuthInstance(),t.isInit=!0,t.prompt=i,t.isAuthorized=t.GoogleAuth.isSignedIn.get()}).catch(o=>{console.error(o)})},m=function(e){this.GoogleAuthConfig=null,this.prompt="",S(this,e),O(this,this.GoogleAuthConfig,this.prompt),this.signIn=(i,o)=>new Promise((a,s)=>{if(!this.GoogleAuth){typeof o=="function"&&o(!1),s(!1);return}this.GoogleAuth.signIn().then(n=>{typeof i=="function"&&i(n),this.isAuthorized=this.GoogleAuth.isSignedIn.get(),a(n)}).catch(n=>{typeof o=="function"&&o(n),s(n)})}),this.getAuthCode=(i,o)=>new Promise((a,s)=>{if(!this.GoogleAuth){typeof o=="function"&&o(!1),s(!1);return}this.GoogleAuth.grantOfflineAccess({prompt:this.prompt}).then(n=>{typeof i=="function"&&i(n.code),a(n.code)}).catch(n=>{typeof o=="function"&&o(n),s(n)})}),this.signOut=(i,o)=>new Promise((a,s)=>{if(!this.GoogleAuth){typeof o=="function"&&o(!1),s(!1);return}this.GoogleAuth.signOut().then(()=>{typeof i=="function"&&i(),this.isAuthorized=!1,a(!0)}).catch(n=>{typeof o=="function"&&o(n),s(n)})})};m.prototype.install=function(e){e.provide(g,this),e.config.globalProperties.$gAuth=this};function b(){const t=y(g);return t||console.error("GAuth plugin isn't install on Vue"),t}function T(t=null){return new m(t)}const B={useGAuth:b,createGAuth:T},l=B.createGAuth({clientId:"416446233465-ohu915ducvkina65jp1ombdae6urbnue.apps.googleusercontent.com",scope:"profile email",prompt:"select_account",ux_mode:"redirect",redirect_uri:document.location.origin}),D=G({name:"GoogleAuth",components:{},mounted(){let t=setInterval(()=>{var e,i;this.isInit=!!l.isInit,this.isAuthorized=!!l.isAuthorized,this.profile=this.googleUserToProfile((i=(e=l==null?void 0:l.GoogleAuth)==null?void 0:e.currentUser)==null?void 0:i.get()),this.isInit&&(clearInterval(t),w.replace({path:"/google-auth"}))},200)},data:()=>({isInit:!1,isAuthorized:!1,showDebug:!1,profile:{}}),methods:{googleUserToProfile(t){const e=t==null?void 0:t.getBasicProfile();return e&&{id:e.getId(),name:e.getName(),givenName:e.getGivenName(),familyName:e.getFamilyName(),imageUrl:e.getImageUrl(),email:e.getEmail()}||{}},async signIn(){const t=await l.signIn();this.isAuthorized=l.isAuthorized,this.profile=this.googleUserToProfile(t)},async signOut(){await l.signOut(),this.isAuthorized=l.isAuthorized,this.profile={}}}}),A=t=>(z("data-v-06965272"),t=t(),_(),t),E=A(()=>d("h1",null,"Google Auth",-1)),$=A(()=>d("p",null,"Example of using Google Auth. If you sign-in with a Google account then you'll see your name below, that's all.",-1)),j={key:0,class:"profile"},U=["src"],V={class:"profile-name"},F={class:"profile-email"},q=["disabled"],C=["disabled"],K={key:3};function L(t,e,i,o,a,s){var n;return p(),h(v,null,[E,u(),$,u(),(n=t.profile)!=null&&n.id?(p(),h("article",j,[d("img",{class:"profile-image",referrerpolicy:"no-referrer",src:t.profile.imageUrl,width:"50",height:"50"},null,8,U),u(),d("h2",V,r(t.profile.name),1),u(),d("p",F,r(t.profile.email),1)])):f("",!0),u(),t.isAuthorized?f("",!0):(p(),h("button",{key:1,type:"button",onClick:e[0]||(e[0]=(...c)=>t.signIn&&t.signIn(...c)),disabled:!t.isInit},`
    Sign-in
  `,8,q)),u(),t.isAuthorized?(p(),h("button",{key:2,type:"button",onClick:e[1]||(e[1]=(...c)=>t.signOut&&t.signOut(...c)),disabled:!t.isInit},`
    Sign-out
  `,8,C)):f("",!0),u(),t.showDebug?(p(),h("pre",K,"isInit: "+r(t.isInit)+`
isAuthorized: `+r(t.isAuthorized)+`
profile: `+r(t.profile)+`
    `,1)):f("",!0)],64)}const J=I(D,[["render",L],["__scopeId","data-v-06965272"]]);export{J as default};
