var Ze=Object.defineProperty;var Je=(o,s,a)=>s in o?Ze(o,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[s]=a;var p=(o,s,a)=>Je(o,typeof s!="symbol"?s+"":s,a);import{f as Qe}from"./xindex.CcXMvAD_.js";import{d as Ke,_ as $e,c as nt,a as v,b as d,w as X,i as ue,f as ti,v as z,F as ei,h as ii,o as rt,p as si,e as ni}from"./xindex.nwv0rKjI.js";import"./x_commonjsHelpers.Cpj98o6Y.js";class ri{constructor(s=0){p(this,"callsPerSecond");p(this,"interval");p(this,"_isDestroyed");p(this,"callCount",0);p(this,"timer");this.callsPerSecond=s,this.interval=this.callsPerSecond<=50&&this.callsPerSecond!==0?20:0,this._isDestroyed=!1}destroy(){this._isDestroyed=!0,clearTimeout(this.timer)}each(s){const r=new Date().getTime();this.callCount=0;const c=()=>{const m=new Date().getTime();for(;!this._isDestroyed;){const w=new Date().getTime();if(this.callsPerSecond!==0){const P=(w-r)*this.callsPerSecond/1e3;if(this.callCount>=P)break}if(w-m>20)break;s(),this.callCount++}(()=>{const P=(new Date().getTime()-r)*this.callsPerSecond/1e3;this.callCount<P&&(this.callCount=P)})(),this._isDestroyed||(this.timer=setTimeout(c,this.interval))};c()}}function fe(o,s){const a=new ri(s);return a.each(o),a}class ce{constructor(s,a){p(this,"width");p(this,"height");p(this,"current");p(this,"constantly");this.width=s,this.height=a,this.current=null}destroy(){var s;(s=this.constantly)==null||s.destroy(),this.constantly=void 0}next(){return this.current?this.current.x==this.width?(this.current.x=0,this.current.y++):this.current.y==this.height?this.current=null:this.current.x++:this.current={x:0,y:0},this.current}each(s){this.constantly=fe(()=>{const a=this.next();a?s(a):this.destroy()})}}class ai extends ce{constructor(a,r,c,m,u,w){super(a,r);p(this,"realMin");p(this,"imagMin");p(this,"realMax");p(this,"imagMax");this.realMin=c,this.imagMin=m,this.realMax=u,this.imagMax=w}each(a){return ce.prototype.each.call(this,r=>{a(this.toComplex(r.x,r.y))})}toComplex(a,r){const c=a/this.width*(this.realMax-this.realMin*1)+this.realMin*1,m=r/this.height*(this.imagMax-this.imagMin)+this.imagMin;return{x:a,y:r,r:c,i:m}}}function at(){let o=1;const s=window.screen;return s.systemXDPI!==void 0&&s.logicalXDPI!==void 0&&s.systemXDPI>s.logicalXDPI?o=s.systemXDPI/s.logicalXDPI:window.devicePixelRatio!==void 0&&(o=window.devicePixelRatio),o}const Pt={fromRGB(o,s,a){return 255<<24|a<<16|s<<8|o},toRGB(o){return{r:o&255,g:o>>8&255,b:o>>16&255}}};class B{constructor(s,a,r){p(this,"width");p(this,"height");p(this,"uint32");p(this,"uint8");p(this,"isPaused",!1);p(this,"_fastPutBuffer");this.width=s,this.height=a,this._createBuffer(),r&&this.loadFromUnknownType(r)}_createBuffer(){const s=new ArrayBuffer(this.width*this.height*4);this.uint32=new Uint32Array(s),this.uint8=new Uint8ClampedArray(s)}loadFromUnknownType(s){s instanceof Uint32Array?this.loadFrom1dArray(s):s instanceof Uint8ClampedArray?this.loadFromUint8ClampedArray(s):typeof s=="function"?this.loadFromFunction(s):typeof s!==null&&(s instanceof Array?s[0]instanceof Array?this.loadFrom2dArray(s):this.loadFrom1dArray(s):this.loadFromInteger(s))}loadFromInteger(s){const a=this.width*this.height;for(let r=0;r<a;++r)this.uint32[r]=+s}loadFrom1dArray(s){const a=this.width*this.height;for(let r=0;r<a;++r)this.uint32[r]=s[r]}loadFrom2dArray(s){const a=this.width*this.height;for(let r=0;r<a;++r)this.uint32[r]=s[~~(r/this.width)][r%this.width]}loadFromUint8ClampedArray(s){const a=this.width*this.height;for(let r=0;r<a*4;++r)this.uint8[r]=s[r]}loadFromFunction(s){const a=this.width*this.height;for(let r=0;r<a;++r)this.uint32[r]=s(r,this.width,this.height,a)}static createFromImageUrl(s,a){const r=document.createElement("img");r.src=s,r.onload=()=>{a(B.createFromImage(r))}}static createFromImage(s){const a=document.createElement("canvas"),r=a.getContext("2d");return a.width=s.width,a.height=s.height,r.drawImage(s,0,0),B.createFromCanvas(a)}static createFromCanvas(s){const a=s.getContext("2d").getImageData(0,0,s.width,s.height);return B.createFromImageData(a,s.width,s.height)}static createFromImageData(s,a,r){return new B(a,r,s.data)}clone(){return new B(this.width,this.height,this.uint8)}toCanvas(s){s=s||document.createElement("canvas"),s.width=this.width,s.height=this.height;const a=s.getContext("2d");return this.toContext(a),s}toContext(s){(!this._fastPutBuffer||this._fastPutBuffer.width!==this.width||this._fastPutBuffer.height!==this.height)&&(this._fastPutBuffer=s.createImageData(this.width,this.height)),this._fastPutBuffer.data.set(this.uint8),s.putImageData(this._fastPutBuffer,0,0)}resizeTo(s,a){const r=this.toCanvas();this.isPaused=!0,this.width=s,this.height=a,this._createBuffer(),this.isPaused=!1,(m=>{const u=document.createElement("canvas");u.width=this.width,u.height=this.height;const w=u.getContext("2d");w.drawImage(m,0,0,this.width,this.height);const P=w.getImageData(0,0,this.width,this.height).data;for(let _=0;_<P.length;_++)this.uint8[_]=P[_]}).call(this,r)}}const oi=B;class hi extends oi{constructor(a,r=25,c=!0){super(a.width,a.height);p(this,"canvas");p(this,"fps");p(this,"hiRes");p(this,"redrawRate");p(this,"context");p(this,"constantly");p(this,"canvasUpdateIsRequired",!1);this.canvas=a,this.fps=r,this.hiRes=c,this.redrawRate=20,this.context=a.getContext("2d"),this.refresh(),this.constantly=fe(()=>{this.canvasUpdateIsRequired&&this.update()},this.fps)}refresh(a,r){a=a||Math.round(this.canvas.offsetWidth*(this.hiRes?at():1)),r=r||Math.round(this.canvas.offsetHeight*(this.hiRes?at():1)),this.canvas.width=a,this.canvas.height=r,this.resizeTo(a,r)}destroy(){this.constantly&&(this.constantly.destroy(),this.constantly=null)}update(){this.toContext(this.context),this.canvasUpdateIsRequired=!1}getCanvasPoint(a,r){return{x:a*(this.hiRes?at():1),y:r*(this.hiRes?at():1)}}}class li extends hi{constructor(s,a=25,r=!0){super(s,a,r)}clear(s){const a=this.width*this.height;for(let r=0;r<a;r++)this.uint32[r]=s;this.canvasUpdateIsRequired=!0}getPoint(s,a){return this.uint32[~~a*this.width+~~s]}setPoint(s,a,r){this.uint32[~~a*this.width+~~s]=r,this.canvasUpdateIsRequired=!0}subtractPoint(s,a,r){const c=Pt.toRGB(this.getPoint(s,a)),m=Pt.toRGB(r);this.uint32[~~a*this.width+~~s]=Pt.fromRGB(Math.max(c.r-m.r,0),Math.max(c.g-m.g,0),Math.max(c.b-m.b,0)),this.canvasUpdateIsRequired=!0}}function ui(o){let s=0,a=0,r=o;for(;r&&!isNaN(r.offsetLeft)&&!isNaN(r.offsetTop);)s+=r.offsetLeft-r.scrollLeft,a+=r.offsetTop-r.scrollTop,r=r.offsetParent;return{x:s,y:a}}function ci(o){const{x:s,y:a}=ui(o),r=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,c=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:s-r,y:a-c}}var fi={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(o){(function(s,a,r,c){var m=["","webkit","Moz","MS","ms","o"],u=a.createElement("div"),w="function",P=Math.round,_=Math.abs,Ct=Date.now;function Mt(t,e,i){return setTimeout(_t(t,i),e)}function G(t,e,i){return Array.isArray(t)?(U(t,i[e],i),!0):!1}function U(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==c)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function Xt(t,e,i){var n="DEPRECATED METHOD: "+e+`
`+i+` AT 
`;return function(){var h=new Error("get-stack-trace"),l=h&&h.stack?h.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",f=s.console&&(s.console.warn||s.console.log);return f&&f.call(s.console,n,l),t.apply(this,arguments)}}var R;typeof Object.assign!="function"?R=function(e){if(e===c||e===null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),n=1;n<arguments.length;n++){var h=arguments[n];if(h!==c&&h!==null)for(var l in h)h.hasOwnProperty(l)&&(i[l]=h[l])}return i}:R=Object.assign;var Yt=Xt(function(e,i,n){for(var h=Object.keys(i),l=0;l<h.length;)(!n||n&&e[h[l]]===c)&&(e[h[l]]=i[h[l]]),l++;return e},"extend","Use `assign`."),de=Xt(function(e,i){return Yt(e,i,!0)},"merge","Use `assign`.");function M(t,e,i){var n=e.prototype,h;h=t.prototype=Object.create(n),h.constructor=t,h._super=n,i&&R(h,i)}function _t(t,e){return function(){return t.apply(e,arguments)}}function Nt(t,e){return typeof t==w?t.apply(e&&e[0]||c,e):t}function Ht(t,e){return t===c?e:t}function ot(t,e,i){U(lt(e),function(n){t.addEventListener(n,i,!1)})}function ht(t,e,i){U(lt(e),function(n){t.removeEventListener(n,i,!1)})}function kt(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function k(t,e){return t.indexOf(e)>-1}function lt(t){return t.trim().split(/\s+/g)}function j(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function ut(t){return Array.prototype.slice.call(t,0)}function Wt(t,e,i){for(var n=[],h=[],l=0;l<t.length;){var f=t[l][e];j(h,f)<0&&n.push(t[l]),h[l]=f,l++}return n=n.sort(function(y,I){return y[e]>I[e]}),n}function ct(t,e){for(var i,n,h=e[0].toUpperCase()+e.slice(1),l=0;l<m.length;){if(i=m[l],n=i?i+h:e,n in t)return n;l++}return c}var pe=1;function ve(){return pe++}function Vt(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||s}var me=/mobile|tablet|ip(ad|hone|od)|android/i,qt="ontouchstart"in s,ge=ct(s,"PointerEvent")!==c,Te=qt&&me.test(navigator.userAgent),J="touch",ye="pen",At="mouse",Ee="kinect",Ie=25,E=1,W=2,g=4,C=8,ft=1,Q=2,K=4,$=8,tt=16,b=Q|K,V=$|tt,zt=b|V,Bt=["x","y"],dt=["clientX","clientY"];function N(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(n){Nt(t.options.enable,[t])&&i.handler(n)},this.init()}N.prototype={handler:function(){},init:function(){this.evEl&&ot(this.element,this.evEl,this.domHandler),this.evTarget&&ot(this.target,this.evTarget,this.domHandler),this.evWin&&ot(Vt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ht(this.element,this.evEl,this.domHandler),this.evTarget&&ht(this.target,this.evTarget,this.domHandler),this.evWin&&ht(Vt(this.element),this.evWin,this.domHandler)}};function Pe(t){var e,i=t.options.inputClass;return i?e=i:ge?e=wt:Te?e=mt:qt?e=Rt:e=vt,new e(t,Ce)}function Ce(t,e,i){var n=i.pointers.length,h=i.changedPointers.length,l=e&E&&n-h===0,f=e&(g|C)&&n-h===0;i.isFirst=!!l,i.isFinal=!!f,l&&(t.session={}),i.eventType=e,Me(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function Me(t,e){var i=t.session,n=e.pointers,h=n.length;i.firstInput||(i.firstInput=Gt(e)),h>1&&!i.firstMultiple?i.firstMultiple=Gt(e):h===1&&(i.firstMultiple=!1);var l=i.firstInput,f=i.firstMultiple,T=f?f.center:l.center,y=e.center=jt(n);e.timeStamp=Ct(),e.deltaTime=e.timeStamp-l.timeStamp,e.angle=Ot(T,y),e.distance=pt(T,y),_e(i,e),e.offsetDirection=Jt(e.deltaX,e.deltaY);var I=Zt(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=I.x,e.overallVelocityY=I.y,e.overallVelocity=_(I.x)>_(I.y)?I.x:I.y,e.scale=f?Oe(f.pointers,n):1,e.rotation=f?Ae(f.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,Ne(i,e);var x=t.element;kt(e.srcEvent.target,x)&&(x=e.srcEvent.target),e.target=x}function _e(t,e){var i=e.center,n=t.offsetDelta||{},h=t.prevDelta||{},l=t.prevInput||{};(e.eventType===E||l.eventType===g)&&(h=t.prevDelta={x:l.deltaX||0,y:l.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=h.x+(i.x-n.x),e.deltaY=h.y+(i.y-n.y)}function Ne(t,e){var i=t.lastInterval||e,n=e.timeStamp-i.timeStamp,h,l,f,T;if(e.eventType!=C&&(n>Ie||i.velocity===c)){var y=e.deltaX-i.deltaX,I=e.deltaY-i.deltaY,x=Zt(n,y,I);l=x.x,f=x.y,h=_(x.x)>_(x.y)?x.x:x.y,T=Jt(y,I),t.lastInterval=e}else h=i.velocity,l=i.velocityX,f=i.velocityY,T=i.direction;e.velocity=h,e.velocityX=l,e.velocityY=f,e.direction=T}function Gt(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:P(t.pointers[i].clientX),clientY:P(t.pointers[i].clientY)},i++;return{timeStamp:Ct(),pointers:e,center:jt(e),deltaX:t.deltaX,deltaY:t.deltaY}}function jt(t){var e=t.length;if(e===1)return{x:P(t[0].clientX),y:P(t[0].clientY)};for(var i=0,n=0,h=0;h<e;)i+=t[h].clientX,n+=t[h].clientY,h++;return{x:P(i/e),y:P(n/e)}}function Zt(t,e,i){return{x:e/t||0,y:i/t||0}}function Jt(t,e){return t===e?ft:_(t)>=_(e)?t<0?Q:K:e<0?$:tt}function pt(t,e,i){i||(i=Bt);var n=e[i[0]]-t[i[0]],h=e[i[1]]-t[i[1]];return Math.sqrt(n*n+h*h)}function Ot(t,e,i){i||(i=Bt);var n=e[i[0]]-t[i[0]],h=e[i[1]]-t[i[1]];return Math.atan2(h,n)*180/Math.PI}function Ae(t,e){return Ot(e[1],e[0],dt)+Ot(t[1],t[0],dt)}function Oe(t,e){return pt(e[0],e[1],dt)/pt(t[0],t[1],dt)}var we={mousedown:E,mousemove:W,mouseup:g},Re="mousedown",be="mousemove mouseup";function vt(){this.evEl=Re,this.evWin=be,this.pressed=!1,N.apply(this,arguments)}M(vt,N,{handler:function(e){var i=we[e.type];i&E&&e.button===0&&(this.pressed=!0),i&W&&e.which!==1&&(i=g),this.pressed&&(i&g&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[e],changedPointers:[e],pointerType:At,srcEvent:e}))}});var Se={pointerdown:E,pointermove:W,pointerup:g,pointercancel:C,pointerout:C},xe={2:J,3:ye,4:At,5:Ee},Qt="pointerdown",Kt="pointermove pointerup pointercancel";s.MSPointerEvent&&!s.PointerEvent&&(Qt="MSPointerDown",Kt="MSPointerMove MSPointerUp MSPointerCancel");function wt(){this.evEl=Qt,this.evWin=Kt,N.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}M(wt,N,{handler:function(e){var i=this.store,n=!1,h=e.type.toLowerCase().replace("ms",""),l=Se[h],f=xe[e.pointerType]||e.pointerType,T=f==J,y=j(i,e.pointerId,"pointerId");l&E&&(e.button===0||T)?y<0&&(i.push(e),y=i.length-1):l&(g|C)&&(n=!0),!(y<0)&&(i[y]=e,this.callback(this.manager,l,{pointers:i,changedPointers:[e],pointerType:f,srcEvent:e}),n&&i.splice(y,1))}});var De={touchstart:E,touchmove:W,touchend:g,touchcancel:C},Ue="touchstart",Fe="touchstart touchmove touchend touchcancel";function $t(){this.evTarget=Ue,this.evWin=Fe,this.started=!1,N.apply(this,arguments)}M($t,N,{handler:function(e){var i=De[e.type];if(i===E&&(this.started=!0),!!this.started){var n=Le.call(this,e,i);i&(g|C)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,i,{pointers:n[0],changedPointers:n[1],pointerType:J,srcEvent:e})}}});function Le(t,e){var i=ut(t.touches),n=ut(t.changedTouches);return e&(g|C)&&(i=Wt(i.concat(n),"identifier")),[i,n]}var Xe={touchstart:E,touchmove:W,touchend:g,touchcancel:C},Ye="touchstart touchmove touchend touchcancel";function mt(){this.evTarget=Ye,this.targetIds={},N.apply(this,arguments)}M(mt,N,{handler:function(e){var i=Xe[e.type],n=He.call(this,e,i);n&&this.callback(this.manager,i,{pointers:n[0],changedPointers:n[1],pointerType:J,srcEvent:e})}});function He(t,e){var i=ut(t.touches),n=this.targetIds;if(e&(E|W)&&i.length===1)return n[i[0].identifier]=!0,[i,i];var h,l,f=ut(t.changedTouches),T=[],y=this.target;if(l=i.filter(function(I){return kt(I.target,y)}),e===E)for(h=0;h<l.length;)n[l[h].identifier]=!0,h++;for(h=0;h<f.length;)n[f[h].identifier]&&T.push(f[h]),e&(g|C)&&delete n[f[h].identifier],h++;if(T.length)return[Wt(l.concat(T),"identifier"),T]}var ke=2500,te=25;function Rt(){N.apply(this,arguments);var t=_t(this.handler,this);this.touch=new mt(this.manager,t),this.mouse=new vt(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}M(Rt,N,{handler:function(e,i,n){var h=n.pointerType==J,l=n.pointerType==At;if(!(l&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(h)We.call(this,i,n);else if(l&&Ve.call(this,n))return;this.callback(e,i,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function We(t,e){t&E?(this.primaryTouch=e.changedPointers[0].identifier,ee.call(this,e)):t&(g|C)&&ee.call(this,e)}function ee(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY};this.lastTouches.push(i);var n=this.lastTouches,h=function(){var l=n.indexOf(i);l>-1&&n.splice(l,1)};setTimeout(h,ke)}}function Ve(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var h=this.lastTouches[n],l=Math.abs(e-h.x),f=Math.abs(i-h.y);if(l<=te&&f<=te)return!0}return!1}var ie=ct(u.style,"touchAction"),se=ie!==c,ne="compute",re="auto",bt="manipulation",q="none",et="pan-x",it="pan-y",gt=ze();function St(t,e){this.manager=t,this.set(e)}St.prototype={set:function(t){t==ne&&(t=this.compute()),se&&this.manager.element.style&&gt[t]&&(this.manager.element.style[ie]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return U(this.manager.recognizers,function(e){Nt(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),qe(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented){e.preventDefault();return}var n=this.actions,h=k(n,q)&&!gt[q],l=k(n,it)&&!gt[it],f=k(n,et)&&!gt[et];if(h){var T=t.pointers.length===1,y=t.distance<2,I=t.deltaTime<250;if(T&&y&&I)return}if(!(f&&l)&&(h||l&&i&b||f&&i&V))return this.preventSrc(e)},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};function qe(t){if(k(t,q))return q;var e=k(t,et),i=k(t,it);return e&&i?q:e||i?e?et:it:k(t,bt)?bt:re}function ze(){if(!se)return!1;var t={},e=s.CSS&&s.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){t[i]=e?s.CSS.supports("touch-action",i):!0}),t}var Tt=1,A=2,Z=4,Y=8,F=Y,st=16,S=32;function L(t){this.options=R({},this.defaults,t||{}),this.id=ve(),this.manager=null,this.options.enable=Ht(this.options.enable,!0),this.state=Tt,this.simultaneous={},this.requireFail=[]}L.prototype={defaults:{},set:function(t){return R(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(G(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=yt(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return G(t,"dropRecognizeWith",this)?this:(t=yt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(G(t,"requireFailure",this))return this;var e=this.requireFail;return t=yt(t,this),j(e,t)===-1&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(G(t,"dropRequireFailure",this))return this;t=yt(t,this);var e=j(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,i=this.state;function n(h){e.manager.emit(h,t)}i<Y&&n(e.options.event+ae(i)),n(e.options.event),t.additionalEvent&&n(t.additionalEvent),i>=Y&&n(e.options.event+ae(i))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=S},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(S|Tt)))return!1;t++}return!0},recognize:function(t){var e=R({},t);if(!Nt(this.options.enable,[this,e])){this.reset(),this.state=S;return}this.state&(F|st|S)&&(this.state=Tt),this.state=this.process(e),this.state&(A|Z|Y|st)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}};function ae(t){return t&st?"cancel":t&Y?"end":t&Z?"move":t&A?"start":""}function oe(t){return t==tt?"down":t==$?"up":t==Q?"left":t==K?"right":""}function yt(t,e){var i=e.manager;return i?i.get(t):t}function O(){L.apply(this,arguments)}M(O,L,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return e===0||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=e&(A|Z),h=this.attrTest(t);return n&&(i&C||!h)?e|st:n||h?i&g?e|Y:e&A?e|Z:A:S}});function Et(){O.apply(this,arguments),this.pX=null,this.pY=null}M(Et,O,{defaults:{event:"pan",threshold:10,pointers:1,direction:zt},getTouchAction:function(){var t=this.options.direction,e=[];return t&b&&e.push(it),t&V&&e.push(et),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,h=t.direction,l=t.deltaX,f=t.deltaY;return h&e.direction||(e.direction&b?(h=l===0?ft:l<0?Q:K,i=l!=this.pX,n=Math.abs(t.deltaX)):(h=f===0?ft:f<0?$:tt,i=f!=this.pY,n=Math.abs(t.deltaY))),t.direction=h,i&&n>e.threshold&&h&e.direction},attrTest:function(t){return O.prototype.attrTest.call(this,t)&&(this.state&A||!(this.state&A)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=oe(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}});function xt(){O.apply(this,arguments)}M(xt,O,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[q]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&A)},emit:function(t){if(t.scale!==1){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}});function Dt(){L.apply(this,arguments),this._timer=null,this._input=null}M(Dt,L,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[re]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,h=t.deltaTime>e.time;if(this._input=t,!n||!i||t.eventType&(g|C)&&!h)this.reset();else if(t.eventType&E)this.reset(),this._timer=Mt(function(){this.state=F,this.tryEmit()},e.time,this);else if(t.eventType&g)return F;return S},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===F&&(t&&t.eventType&g?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=Ct(),this.manager.emit(this.options.event,this._input)))}});function Ut(){O.apply(this,arguments)}M(Ut,O,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[q]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&A)}});function Ft(){O.apply(this,arguments)}M(Ft,O,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:b|V,pointers:1},getTouchAction:function(){return Et.prototype.getTouchAction.call(this)},attrTest:function(t){var e=this.options.direction,i;return e&(b|V)?i=t.overallVelocity:e&b?i=t.overallVelocityX:e&V&&(i=t.overallVelocityY),this._super.attrTest.call(this,t)&&e&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&_(i)>this.options.velocity&&t.eventType&g},emit:function(t){var e=oe(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}});function It(){L.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}M(It,L,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[bt]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,h=t.deltaTime<e.time;if(this.reset(),t.eventType&E&&this.count===0)return this.failTimeout();if(n&&h&&i){if(t.eventType!=g)return this.failTimeout();var l=this.pTime?t.timeStamp-this.pTime<e.interval:!0,f=!this.pCenter||pt(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,!f||!l?this.count=1:this.count+=1,this._input=t;var T=this.count%e.taps;if(T===0)return this.hasRequireFailures()?(this._timer=Mt(function(){this.state=F,this.tryEmit()},e.interval,this),A):F}return S},failTimeout:function(){return this._timer=Mt(function(){this.state=S},this.options.interval,this),S},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==F&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function H(t,e){return e=e||{},e.recognizers=Ht(e.recognizers,H.defaults.preset),new Lt(t,e)}H.VERSION="2.0.7",H.defaults={domEvents:!1,touchAction:ne,enable:!0,inputTarget:null,inputClass:null,preset:[[Ut,{enable:!1}],[xt,{enable:!1},["rotate"]],[Ft,{direction:b}],[Et,{direction:b},["swipe"]],[It],[It,{event:"doubletap",taps:2},["tap"]],[Dt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Be=1,he=2;function Lt(t,e){this.options=R({},H.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=Pe(this),this.touchAction=new St(this,this.options.touchAction),le(this,!0),U(this.options.recognizers,function(i){var n=this.add(new i[0](i[1]));i[2]&&n.recognizeWith(i[2]),i[3]&&n.requireFailure(i[3])},this)}Lt.prototype={set:function(t){return R(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?he:Be},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var i,n=this.recognizers,h=e.curRecognizer;(!h||h&&h.state&F)&&(h=e.curRecognizer=null);for(var l=0;l<n.length;)i=n[l],e.stopped!==he&&(!h||i==h||i.canRecognizeWith(h))?i.recognize(t):i.reset(),!h&&i.state&(A|Z|Y)&&(h=e.curRecognizer=i),l++}},get:function(t){if(t instanceof L)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(G(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(G(t,"remove",this))return this;if(t=this.get(t),t){var e=this.recognizers,i=j(e,t);i!==-1&&(e.splice(i,1),this.touchAction.update())}return this},on:function(t,e){if(t!==c&&e!==c){var i=this.handlers;return U(lt(t),function(n){i[n]=i[n]||[],i[n].push(e)}),this}},off:function(t,e){if(t!==c){var i=this.handlers;return U(lt(t),function(n){e?i[n]&&i[n].splice(j(i[n],e),1):delete i[n]}),this}},emit:function(t,e){this.options.domEvents&&Ge(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(!(!i||!i.length)){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},destroy:function(){this.element&&le(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function le(t,e){var i=t.element;if(i.style){var n;U(t.options.cssProps,function(h,l){n=ct(i.style,l),e?(t.oldCssProps[n]=i.style[n],i.style[n]=h):i.style[n]=t.oldCssProps[n]||""}),e||(t.oldCssProps={})}}function Ge(t,e){var i=a.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}R(H,{INPUT_START:E,INPUT_MOVE:W,INPUT_END:g,INPUT_CANCEL:C,STATE_POSSIBLE:Tt,STATE_BEGAN:A,STATE_CHANGED:Z,STATE_ENDED:Y,STATE_RECOGNIZED:F,STATE_CANCELLED:st,STATE_FAILED:S,DIRECTION_NONE:ft,DIRECTION_LEFT:Q,DIRECTION_RIGHT:K,DIRECTION_UP:$,DIRECTION_DOWN:tt,DIRECTION_HORIZONTAL:b,DIRECTION_VERTICAL:V,DIRECTION_ALL:zt,Manager:Lt,Input:N,TouchAction:St,TouchInput:mt,MouseInput:vt,PointerEventInput:wt,TouchMouseInput:Rt,SingleTouchInput:$t,Recognizer:L,AttrRecognizer:O,Tap:It,Pan:Et,Swipe:Ft,Pinch:xt,Rotate:Ut,Press:Dt,on:ot,off:ht,each:U,merge:de,extend:Yt,assign:R,inherit:M,bindFn:_t,prefixed:ct});var je=typeof s<"u"?s:typeof self<"u"?self:{};je.Hammer=H,o.exports?o.exports=H:s[r]=H})(window,document,"Hammer")})(fi);const di=Ke({name:"Mandelbrot",setup(){return{canvasWriter:void 0,fullscreen:null,grid:void 0,width:void 0,height:void 0}},data(){return{redrawRate:20,realMin:-2.5,realMax:1.5,imagMin:-2,imagMax:2,hiRes:!1,maxIterations:50,julia:!1,juliaR:-1,juliaI:0,snapshots:[]}},mounted(){const o=document.getElementsByClassName("touch-area")[0],s=new Hammer.Manager(o),a=new Hammer.Pinch;s.add(a),s.on("pinchend",this.pinch),this.update()},beforeUnmount(){this.destroyChildObjects()},computed:{isHiResAvailable(){return at()!==1}},methods:{snapshot(){this.snapshots.push(this.canvasWriter.toCanvas().toDataURL())},reset(){this.realMin=-2.5,this.realMax=1.5,this.imagMin=-2,this.imagMax=2,this.julia=!1,this.juliaR=-1,this.juliaI=0,this.hiRes=!1,this.maxIterations=50,this.update()},pinch(o){const s=o,a=ci(o.target),r=this.canvasWriter.getCanvasPoint(o.center.x-a.x,o.center.y-a.y),c=this.grid.toComplex(r.x,r.y),m=s.additionalEvent==="pinchin"?.5:2;this.zoom(c,m)},clickZoom(o){const s=this.canvasWriter.getCanvasPoint(o.offsetX,o.offsetY),a=this.grid.toComplex(s.x,s.y),r=o.shiftKey?.5:2;this.zoom(a,r)},openFullscreen(o){const s=()=>{const c=document.getElementById("mandelbrot-canvas");c.style.width=screen.width+"px",c.style.height=screen.height+"px",this.update()},a=()=>{var m;const c=document.getElementById("mandelbrot-canvas");c.style.width="",c.style.height="",this.update(),(m=this.fullscreen)==null||m.dispose(),this.fullscreen=null};this.fullscreen&&this.fullscreen.dispose();const r=document.getElementById("mandelbrot-canvas");this.fullscreen=Qe(r),this.fullscreen.on("attain",s),this.fullscreen.on("release",a),this.fullscreen.on("error",()=>{console.error("fullscreen not supported")}),this.fullscreen.request()},zoom(o,s){const a=this.grid.realMax-this.grid.realMin,r=this.grid.imagMax-this.grid.imagMin;this.realMin=o.r-a/2/s,this.realMax=o.r+a/2/s,this.imagMin=o.i-r/2/s,this.imagMax=o.i+r/2/s,this.update()},destroyChildObjects(){var o,s,a;(o=this.canvasWriter)==null||o.destroy(),(s=this.grid)==null||s.destroy(),(a=this.fullscreen)==null||a.dispose()},update(){this.grid&&this.grid.destroy();const o=document.getElementById("mandelbrot-canvas");this.canvasWriter?(this.canvasWriter.hiRes=this.hiRes,this.canvasWriter.refresh()):this.canvasWriter=new li(o,void 0,this.hiRes),this.height=this.canvasWriter.height,this.width=this.canvasWriter.width,this.grid=new ai(this.width,this.height,this.realMin,this.imagMin,this.realMax,this.imagMax),this.grid.each(s=>{const a=this.calculate(s);this.setPointColor(s,a)})},calculate(o){let s=0,a=0,r={r:o.r,i:o.i};for(;a<this.maxIterations;a++){let c=this.julia?this.juliaR:o.r,m=this.julia?this.juliaI:o.i;if(r={r:r.r*r.r-r.i*r.i+c,i:r.r*r.i*2+m},s=r.r*r.r+r.i*r.i,s>4)break}return{iterations:a,value:s,z:r,c:o}},setPointColor(o,s){const a=~~(s.value*6),r=s.value<9?0:~~(s.value*20),c=255-s.iterations/this.maxIterations*255,m=Pt.fromRGB(a,r,c);this.canvasWriter.setPoint(o.x,o.y,m)}}}),D=o=>(si("data-v-bfa4cd8d"),o=o(),ni(),o),pi=D(()=>d("h1",null,[v("Mandelbrot "),d("small",null,"(and Julia)")],-1)),vi=D(()=>d("p",null,`
      A html canvas showing a Mandelbrot set, and some options to show a Julia
      set.
    `,-1)),mi=D(()=>d("p",null,"Click/shift to zoom in and out, or pinch-in/out on touchscreen.",-1)),gi={class:"touch-area"},Ti={key:0,for:"hiRes"},yi=D(()=>d("label",{for:"realMin"},"R min",-1)),Ei=D(()=>d("label",{for:"realMax"},"R max",-1)),Ii=D(()=>d("label",{for:"imagMin"},"i min",-1)),Pi=D(()=>d("label",{for:"imagMax"},"i max",-1)),Ci=D(()=>d("label",{for:"maxIterations"},"max depth",-1)),Mi={for:"julia"},_i=D(()=>d("label",{for:"juliaR"},"Real",-1)),Ni=D(()=>d("label",{for:"juliaI"},"Imaginary",-1)),Ai={class:"snapshots"},Oi=["src"];function wi(o,s,a,r,c,m){return rt(),nt("section",null,[pi,v(),vi,v(),mi,v(),d("figure",gi,[d("canvas",{id:"mandelbrot-canvas",width:"100",height:"100",onClick:s[0]||(s[0]=(...u)=>o.clickZoom&&o.clickZoom(...u))})]),v(),d("fieldset",null,[d("button",{type:"button",onClick:s[1]||(s[1]=(...u)=>o.snapshot&&o.snapshot(...u))},"Snapshot"),v(),d("button",{type:"button",onClick:s[2]||(s[2]=(...u)=>o.reset&&o.reset(...u))},"Reset"),v(),d("button",{type:"button",onClick:s[3]||(s[3]=(...u)=>o.update&&o.update(...u))},"Update"),v(),d("button",{type:"button",onClick:s[4]||(s[4]=(...u)=>o.openFullscreen&&o.openFullscreen(...u))},"Fullscreen"),v(),o.isHiResAvailable?(rt(),nt("label",Ti,[X(d("input",{id:"hiRes","onUpdate:modelValue":s[5]||(s[5]=u=>o.hiRes=u),type:"checkbox",onClick:s[6]||(s[6]=(...u)=>o.update&&o.update(...u))},null,512),[[ue,o.hiRes]]),v(`
        hi-res
      `)])):ti("",!0)]),v(),d("fieldset",null,[yi,v(),X(d("input",{id:"realMin","onUpdate:modelValue":s[7]||(s[7]=u=>o.realMin=u),type:"number",step:"any"},null,512),[[z,o.realMin,void 0,{number:!0}]]),v(),Ei,v(),X(d("input",{id:"realMax","onUpdate:modelValue":s[8]||(s[8]=u=>o.realMax=u),type:"number",step:"any"},null,512),[[z,o.realMax,void 0,{number:!0}]]),v(),Ii,v(),X(d("input",{id:"imagMin","onUpdate:modelValue":s[9]||(s[9]=u=>o.imagMin=u),type:"number",step:"any"},null,512),[[z,o.imagMin,void 0,{number:!0}]]),v(),Pi,v(),X(d("input",{id:"imagMax","onUpdate:modelValue":s[10]||(s[10]=u=>o.imagMax=u),type:"number",step:"any"},null,512),[[z,o.imagMax,void 0,{number:!0}]]),v(),Ci,v(),X(d("input",{id:"maxIterations","onUpdate:modelValue":s[11]||(s[11]=u=>o.maxIterations=u),type:"number"},null,512),[[z,o.maxIterations]])]),v(),d("fieldset",null,[d("label",Mi,[X(d("input",{id:"julia","onUpdate:modelValue":s[12]||(s[12]=u=>o.julia=u),type:"checkbox",onClick:s[13]||(s[13]=(...u)=>o.update&&o.update(...u))},null,512),[[ue,o.julia]]),v(`
        Julia
      `)]),v(),_i,v(),X(d("input",{id:"juliaR","onUpdate:modelValue":s[14]||(s[14]=u=>o.juliaR=u),type:"number",step:"any"},null,512),[[z,o.juliaR,void 0,{number:!0}]]),v(),Ni,v(),X(d("input",{id:"juliaI","onUpdate:modelValue":s[15]||(s[15]=u=>o.juliaI=u),type:"number",step:"any"},null,512),[[z,o.juliaI,void 0,{number:!0}]])]),v(),d("div",Ai,[(rt(!0),nt(ei,null,ii(o.snapshots,u=>(rt(),nt("div",{key:u,class:"snapshot"},[(rt(),nt("img",{src:u,key:u},null,8,Oi))]))),128))])])}const Di=$e(di,[["render",wi],["__scopeId","data-v-bfa4cd8d"]]);export{Di as default};
