import{d as Z,r as j,E as B,j as Q,D as he,o as $,c as L,b as A,H as de,a as D,u as ue,t as ee,_ as te,J as fe,F as xe,h as pe,p as ye,e as we,n as ge,q as Me,A as ke}from"./xindex.nwv0rKjI.js";const ve=(e,n,s)=>Math.min(Math.max(e,n),s),_e=e=>ve(e,0,1);function Se(e,n){return e?(e.width=n.width,e.height=n.height,e.getContext("2d",{willReadFrequently:!0})):null}function Pe(e,n,s,a){const l=Se(e,n);if(!l)return;const r=Math.ceil(n.width),o=Math.ceil(n.height),t=new ImageData(r,o),c=t.data,h=(a==null?void 0:a.x)??0,m=(a==null?void 0:a.y)??0,d=(a==null?void 0:a.zoom)??1,f=r/2,x=o/2,u=f+h,w=x+m;for(let g=0;g<r;++g)for(let M=0;M<o;++M){const k=s((g-f)*d+u,(M-x)*d+w),v=(g+M*r)*4;c[v]=k[0]*255,c[v+1]=k[1]*255,c[v+2]=k[2]*255,c[v+3]=k[3]?k[3]*255:255}l.putImageData(t,0,0)}const Ge={class:"noise-render-slot caption"},Ie=Z({__name:"NoiseRender",props:{dimensions:{},camera:{},frame:{},pixel:{type:Function}},setup(e){const n=j(void 0),s=e,a=B(()=>s.dimensions),l=B(()=>s.pixel),r=j(0),o=()=>{const t=window.performance.now();Pe(n.value,a.value,l.value,s.camera);const c=window.performance.now(),h=a.value.height*a.value.width;r.value=h/(c-t)*1e3};return Q(o),he(s,o),(t,c)=>($(),L("section",null,[A("div",{class:"canvas-wrap",style:de({height:a.value.height+"px",width:a.value.width+"px"})},[A("canvas",{ref_key:"canvas",ref:n,class:"canvas"},null,512)],4),D(),A("div",Ge,[ue(t.$slots,"default",{},void 0,!0),D(" ("+ee((r.value/1e6).toPrecision(3))+`
      Mpix/sec)
    `,1)])]))}}),be=te(Ie,[["__scopeId","data-v-226a14d0"]]);function G(e){const[n,s,a]=e,l=(n*360%360+360)%360,r=Math.floor(l/60),o=l/60-r,t=a*(1-s),c=a*(1-s*o),h=a*(1-s*(1-o)),m=[t,t,h,a,a,c,t,t,h,a];return[m[r+4],m[r+2],m[r]]}const O=e=>{const n=new Uint32Array(new Float64Array([e]).buffer),s=n[0]^n[1]+1440662683;return(a,l,r=0,o=0)=>{const t=s+a*374761393+l*668265263+r*1440662683+o*3865785317;return((t^t>>13)*1274126177>>>0)/4294967295}},ze=(e,n=8)=>{const s=O(e),a=r=>(r*r*(3-r*2)+r)/2,l=(r,o,t)=>r+(o-r)*t;return(r,o)=>{const t=Math.floor(r/n),c=Math.floor(o/n),h=r%n/n,m=o%n/n,d=s(t,c),f=s(t,c+1),x=s(t+1,c),u=s(t+1,c+1),w=a(h),g=a(m),M=l(d,f,g),k=l(x,u,g);return l(M,k,w)}},Ne=(e,n=8)=>{const s=O(e),a=o=>o*o*o*(o*(o*6-15)+10),l=(o,t,c)=>o+(t-o)*c,r=(o,t)=>{const c=s(o,t,1)*2*Math.PI;return{x:Math.cos(c),y:Math.sin(c)}};return(o,t)=>{const c=Math.floor(o/n),h=Math.floor(t/n),m=o/n-c,d=t/n-h,f=r(c,h),x=r(c,h+1),u=r(c+1,h),w=r(c+1,h+1),g=f.x*m+f.y*d,M=x.x*m+x.y*(d-1),k=u.x*(m-1)+u.y*d,v=w.x*(m-1)+w.y*(d-1),_=a(m),I=a(d),N=l(g,M,I),z=l(k,v,I);return l(N,z,_)*.5+.5}},Ce=(e,n,s)=>e*e+n*n+s*s,qe=e=>e**.5,J=(e,n=3,s=8,a=1,l=Ce,r=qe)=>{const o=O(e),t={};return(d,f)=>{const x=d/s,u=f/s,w=Math.floor(x),g=Math.floor(u),M=x-w,k=u-g,v=h(w,g,n,a),_=c(v,l,M,k);return r?r(_):_};function c(d,f,x,u){return d.reduce((w,g)=>Math.min(f(x-g.x,u-g.y,g.z??0),w),1/0)}function h(d,f,x,u){var w;return t[w=`${d}+${f}`]??(t[w]=[m(d,f,0,0,x,u),m(d,f,1,0,x,u),m(d,f,0,1,x,u),m(d,f,1,1,x,u)].flat())}function m(d,f,x,u,w,g){var M;return t[M=`${d}+${x},${f}+${u}`]??(t[M]=Array.from({length:g}).map((k,v)=>{const _=o(d+x,f+u,v)*16777215,I=x+((_&255)/255-.5),N=u+((_>>8&255)/255-.5),z=w==2?0:(_>>16&255)/255-.5;return{x:I,y:N,z}}))}},Ae=(e,n=8)=>{const s=(Math.sqrt(3)-1)/2,a=-(3-Math.sqrt(3))/6,l=2/3,r=O(e);return(t,c)=>{const h=(t+c)*s,m=Math.floor(t+h),d=Math.floor(c+h),f=t+h-m,x=c+h-d;return o(m,d,f,x,0,0)+o(m,d,f,x,1,0)+o(m,d,f,x,0,1)+o(m,d,f,x,1,1)+.5};function o(t,c,h,m,d,f){const x=h-d,u=m-f,w=(x+u)*a,g=x+w,M=u+w,k=l-g*g-M*M;if(k<0)return 0;const v=r(t+d,c+f)*255,_=(v&15)-8,I=(v>>4)-8;return k*k*k*k*(_*g+I*M)}},b=(e,n=8)=>{const s=.3333333333333333,a=1/6,l=3/4,r=O(e);return(t,c,h)=>{const m=t/n,d=c/n,f=h/n,x=(m+d+f)*s,u=Math.floor(m+x),w=Math.floor(d+x),g=Math.floor(f+x),M=m+x-u,k=d+x-w,v=f+x-g;return o(u,w,g,M,k,v,0,0,0)+o(u,w,g,M,k,v,1,0,0)+o(u,w,g,M,k,v,0,1,0)+o(u,w,g,M,k,v,1,1,0)+o(u,w,g,M,k,v,0,0,1)+o(u,w,g,M,k,v,1,0,1)+o(u,w,g,M,k,v,0,1,1)+o(u,w,g,M,k,v,1,1,1)+.5};function o(t,c,h,m,d,f,x,u,w){const g=m-x,M=d-u,k=f-w,v=(g+M+k)*a,_=g-v,I=M-v,N=k-v,z=l-_*_-I*I-N*N;if(z<0)return 0;const F=r(t+x,c+u,h+w)*4095,C=(F&15)-8,T=(F>>4&15)-8,V=(F>>8&15)-8;return z*z*z*z*(C*_+T*I+V*N)/2}},Fe=e=>{const n=b(e,32),s=b(e*24922949,16),a=b(e*50950349,8),l=b(e*73150993,4);return(r,o,t)=>.4*n(r,o,t)+.3*s(r,o,t)+.2*a(r,o,t)+.1*l(r,o,t)},De=e=>(n,s)=>{const r=n/200-2,o=s/200-.25;let t=r,c=o,h=0;const m=(d,f)=>{const x=d*d*d,u=f*f*f,w=d*d,g=f*f,M=x-3*d*g-1,k=3*w*f-u,v=3*(w-g),_=6*d*f;return{pReal:M,pImag:k,dReal:v,dImag:_}};for(;h<50;){const{pReal:d,pImag:f,dReal:x,dImag:u}=m(t,c),w=x*x+u*u;if(w===0)break;const g=t-(d*x+f*u)/w,M=c-(f*x-d*u)/w;if(Math.abs(g-t)<1e-6&&Math.abs(M-c)<1e-6)break;t=g,c=M,h++}return h/50},Oe=e=>{const a=2.6666666666666665,l=.008,r=25;return(o,t)=>{let c=o*.25-18,h=t*.6-12,m=0;for(let f=0;f<r;f++){const x=6*(h-c),u=c*(28-m)-h,w=c*h-a*m;c+=x*l,h+=u*l,m+=w*l}return Math.abs(Math.sqrt(c*c+h*h+m*m)/8%2-1)}},ne={spherize:(e,n,s)=>[e*Math.sin(s*Math.PI/2),n*Math.sin(s*Math.PI/2)],pinch:(e,n,s)=>[e*s*s,n*s*s],bloat:(e,n,s)=>[e*Math.sqrt(s),n*Math.sqrt(s)],wave:(e,n)=>[e+Math.sin(n*.4)*.7,n+Math.sin(e*.4)*.7],punk:(e,n)=>[e+Math.sin(e*.4)*.7,n+Math.cos(n*.4)*.7],twirly:(e,n,s,a)=>[e+s*Math.cos(a+s**.5*5)+n/5,n+s*Math.sin(a+s**.7*5)+e/3],swirl:(e,n,s,a)=>[e+s*Math.cos(a+s*3),n+s*Math.sin(a+s*3)],swirl2:(e,n,s,a)=>[s*Math.cos(a+s*3),s*Math.sin(a+s*3)]},U=Object.keys(ne);U[Math.floor(Math.random()*U.length)];const Re=(e,n)=>(s,a)=>{const r=ne[n],o=s/3-20,t=a/3-10,c=Math.sqrt(o*o+t*t)/8,h=Math.atan2(t,o),[m,d]=r(o,t,c,h),f=Math.sin(m*1+e)*Math.sin(d*1+e);return Math.abs(f)},Ee=e=>{const n=b(e);return(s,a,l)=>{let o=s/500*Math.PI*2*8*1.2,t=a/5*1.2;const h=n(o,t,l)*2;let m=Math.sin(o+h)*20+h*100+50*o/17;return Math.abs(Math.cos((m-t)/10))}};function We(e,n){const s=n.length;if(e<=n[0].x)return n[0].y;if(e>=n[s-1].x)return n[s-1].y;const a=n.findIndex(o=>e<o.x),l=n[a-1],r=n[a];return l.y+(e-l.x)/(r.x-l.x)*(r.y-l.y)}function $e(e,n,s,a,l){const r=2*e*e*e-3*e*e+1,o=-2*e*e*e+3*e*e,t=e*e*e-2*e*e+e,c=e*e*e-e*e,h=r*n.x+o*s.x+t*a.x+c*l.x,m=r*n.y+o*s.y+t*a.y+c*l.y;return{x:h,y:m}}function Le(e,n){if(e.length<2)throw new Error("At least two points are required.");const s=e.slice(0,-1).map((l,r)=>{const o=e[r+1],t=e[r-1]||l,c=e[r+2]||o,h={x:(o.x-t.x)/2,y:(o.y-t.y)/2},m={x:(c.x-l.x)/2,y:(c.y-l.y)/2};return{p0:l,p1:o,m0:h,m1:m}}),a=Array.from({length:n+1},(l,r)=>r/n);return s.flatMap(({p0:l,p1:r,m0:o,m1:t})=>a.map(c=>$e(c,l,r,o,t)))}function E(e,n){const s=Le(e,e.length*3);return s.sort((a,l)=>a.x-l.x),a=>We(a,s)}const q=_e,Te=E([{x:0,y:1},{x:.3,y:.9},{x:.4,y:.4},{x:.5,y:.1},{x:1,y:0}]),Ve=E([{x:0,y:0},{x:.65,y:.12},{x:.75,y:.9},{x:1,y:1}]),je=E([{x:0,y:0},{x:.7,y:.1},{x:.85,y:.9},{x:1,y:1}]),He=E([{x:0,y:1},{x:.35,y:.9},{x:.4,y:.1},{x:1,y:0}]),Ke=E([{x:0,y:0},{x:.25,y:.6},{x:1,y:1}]);G([227/360,.7,.35]),G([231/360,.71,.31]),G([229/360,.47,.64]),G([77/360,.34,.4]),G([92/360,.41,.23]),G([78/360,.24,.27]),G([37/360,.35,.89]),G([31/360,.41,.58]),G([77/360,.34,.4]),G([35/360,.21,.64]);const Xe=e=>{const s=(r=>{const o=b(r*.1,129),t=b(r*.2,47),c=b(r*.3,7),h=b(r*.4,1),m=b(r*.5,71),d=b(r*.5,15),f=b(r*.6,67),x=b(r*.6,13);return(u,w,g)=>{const M=.6*o(u,w,g)+.3*t(u,w,g)+.15*c(u,w,g)+.05*h(u,w,g),k=.7*m(u,w,g)+.3*d(u,w,g),v=.7*f(u,w,g)+.3*x(u,w,g),_=.6,I=M<_,N=((M-_)/(1-_))**.5,z=q(Ke(1-M/_)),F=q(Ve(M)+Te(k)),C=q(He(v)+je(k));return{height:M,isSea:I,heightAboveSeaLevel:N,seaDepth:z,moisture:v,temperature:k,iciness:F,desert:C}}})(e),l={dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"World (a better version exists on another page)",pixel:(r,o)=>{const t=s(r,o,l.frame),c=t.heightAboveSeaLevel,h=t.seaDepth,m=t.moisture,d=t.temperature,f=t.iciness,x=t.desert;if(t.isSea){const u=[.6361111111111111,.47+h*.242-.1+d*.2,.25+(1-h)*.33+.05-m*.1];return G([u[0],q(u[1]-.2*f),q(u[2]+.2*f)])}else{const u=[.21388888888888888-c*.08888888888888889-.044444444444444446+m*.1388888888888889,.34-c*.13+(1-m)*.05+.1-(1-d)*.2,.4-c*.24-.25+(1-m)*.6-(1-d)*.1];return G([u[0]-x*.1,q(u[1]-.3*f+x*.1),q(u[2]+.6*f+x*.45)])}},frame:0,selected:!1};return l},Ye=e=>(n,s)=>{const a=n/300-2,l=s/300-.05,r=40;let o=0,t=0,c=0;for(;o*o+t*t<=4&&c<r;){const h=o*o-t*t+a;t=2*o*t+l,o=h,++c}return c/r},Be=e=>(s,a,l)=>{const r=.355+Math.sin(l)/200,o=.355+Math.cos(l)/200,t=s/300-1,c=a/300-1;let h=t,m=c,d=0;for(;h*h+m*m<=4&&d<150;){const f=h*h-m*m+r;m=2*h*m+o,h=f,++d}return{iteration:d,maxIterations:150,r:h,i:m,x:s,y:a,r0:t,i0:c}},Je=e=>(n,s)=>{let a=n,l=s,r=!0;for(;a>0||l>0;){if(a%2===1&&l%2===1){r=!1;break}a=Math.floor(a/2),l=Math.floor(l/2)}return r?1:0},H=e=>(ye("data-v-c4ff0663"),e=e(),we(),e),Ue=H(()=>A("h1",null,"Noise",-1)),Ze=H(()=>A("p",null,`
      Whilst generating maps I looked at different ways to generate noise,
      splines and curves. This page shows what different algorithms look like
      and gives some indication of how fast they are.
    `,-1)),Qe=H(()=>A("p",null,`
      Key board shortcuts include W A S D, T F G H, ' / use Ctrl+click to
      multi-select
    `,-1)),et={class:"panels"},S=12345,tt=Z({__name:"Noise",setup(e){const n=O(S),s=(p,y)=>{const i=n(p,y);return[i,i,i]},a=(p,y)=>[n(p,y,0),n(p,y,1),n(p,y,2)],l=ze(S),r=(p,y)=>{const i=l(p,y);return[i,i,i]},o=Ne(S),t=(p,y)=>{const i=o(p,y);return[i,i,i]},c=Ae(S),h=(p,y)=>{const i=c(p,y);return[i,i,i]},m=b(S),f={dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"OpenSimplex 3d",pixel:(p,y)=>{const i=m(p,y,f.frame/5);return[i,i,i]},frame:0,selected:!1},x=J(S),w={dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"Worley (Voronoi)",pixel:(p,y)=>{const i=x(p,y);let P=w.frame/1e3;return P=P-(P|0),G([P,1-i**.5,i])},frame:0,selected:!1},g=J(S,3,8,32),M=(p,y)=>{const i=(1-g(p,y))**16;return[i,i,i]},k=Fe(S),_={dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"Fractal",pixel:(p,y)=>{const i=k(p,y,_.frame/3);return[i,i,i]},frame:0,selected:!1},I=Ye(S),N=(p,y)=>{const i=I(p,y);return[i,i,i]},z=Be(S),C={dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"Julia",pixel:(p,y)=>{const i=z(p,y,C.frame/100),P=i.iteration===i.maxIterations?1:i.iteration/i.maxIterations;return G([C.frame/1e4-P*.7,1-P**.5,P])},frame:0,selected:!1},T=De(S),V=(p,y)=>{const i=T(p,y);return[i,i,i]},oe=Oe(S),se=(p,y)=>{const i=oe(p,y);return[i,i,i]},re=Je(S),ae=(p,y)=>{const i=re(p,y);return[i,i,i]},ce=Re(S,"twirly"),ie=(p,y)=>{const i=ce(p,y);return[i,i,i]},le=Ee(S),K={dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"OpenSimplex + trigonometry",pixel:(p,y)=>{const i=le(p,y,K.frame/10);return G([i+.9,i**2,1-i*.9])},frame:0,selected:!1},R=j([{dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"Value noise",pixel:r,frame:0,selected:!1},{dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"Pseudo-random pixels.",pixel:s,frame:0,selected:!1},{dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"Pseudo-random pixels in color.",pixel:a,frame:0,selected:!1},{dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"Perlin",pixel:t,frame:0,selected:!1},{dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"OpenSimplex",pixel:h,frame:0,selected:!1},f,w,{dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"Worley (Starfield)",pixel:M,frame:0,selected:!1},_,{dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"Mandelbrot",pixel:N,frame:0,selected:!1},C,{dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"Newton Raphson",pixel:V,frame:0,selected:!1},{dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"Sierpinski",pixel:ae,frame:0,selected:!1},{dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"Lorenz attractor",pixel:se,frame:0,selected:!1},{dimensions:{width:300,height:150},camera:{x:0,y:0,zoom:1},title:"Trigonometry (various options)",pixel:ie,frame:0,selected:!1},K,Xe(S)]);function me(p,y){y.ctrlKey||R.value.filter(P=>P.selected&&P!==p).forEach(P=>P.selected=!1),p.selected=!p.selected}let W=null;const X=()=>{R.value.filter(p=>p.selected).forEach(p=>++p.frame),W=requestAnimationFrame(X)};Q(async()=>{document.addEventListener("keydown",Y),X()}),fe(()=>{document.removeEventListener("keydown",Y),W&&cancelAnimationFrame(W),W=null});const Y=p=>{if(p.key==="a"&&p.ctrlKey)return R.value.forEach(y=>y.selected=!0);R.value.filter(y=>y.selected).forEach(y=>{const i=y.camera.zoom;p.key==="a"&&(y.camera.x-=25*i),p.key==="d"&&(y.camera.x+=25*i),p.key==="w"&&(y.camera.y-=25*i),p.key==="s"&&(y.camera.y+=25*i),p.key==="'"&&(y.camera.zoom/=1.2),p.key==="/"&&(y.camera.zoom*=1.2),p.key==="t"&&(y.dimensions.height+=50),p.key==="g"&&(y.dimensions.height-=50),p.key==="h"&&(y.dimensions.width+=50),p.key==="f"&&(y.dimensions.width-=50),y.dimensions.height<50&&(y.dimensions.height=50),y.dimensions.width<50&&(y.dimensions.width=50)}),console.log(p.key)};return(p,y)=>($(),L("section",null,[Ue,D(),Ze,D(),Qe,D(),A("div",et,[($(!0),L(xe,null,pe(R.value,i=>($(),L("div",{class:ge([{selected:i.selected},"panel"])},[Me(be,{dimensions:i.dimensions,camera:i.camera,pixel:i.pixel,frame:i.frame,onClick:P=>me(i,P)},{default:ke(()=>[D(ee(i.title),1)]),_:2},1032,["dimensions","camera","pixel","frame","onClick"])],2))),256))])]))}}),st=te(tt,[["__scopeId","data-v-c4ff0663"]]);export{st as default};
